import{d as A,r as h,e as E,O as T,o as p,c as g,f as d,w as n,u as a,x as w,D as v,I,J as U,b as N,g as f,h as c,i as C,j,Q as q,k as z,l as P,m as G,y as D,p as H,a as J,P as L,_ as M}from"./entry.76a73718.js";/* empty css                 *//* empty css                *//* empty css                       *//* empty css                        *//* empty css                  */import{D as O,E as Q,F as K,G as W,H as X,I as Y}from"./adminManage.33df6487.js";import{t as Z}from"./throttle.46d02480.js";import"./request.4efd7232.js";const ee=m=>(H("data-v-efa74795"),m=m(),J(),m),te={class:"w-fit text-[#EBEBEB] pl-10 mt-10 overflow-auto"},re=ee(()=>N("p",{class:"text-red-500 text-[12px] ml-24 mb-2"},"注：多个账户用逗号隔开",-1)),le={class:"w-full flex justify-end"},ae=A({__name:"reward-distribution",setup(m){const x=h(),B=[{value:1,key:1,label:"snft"},{value:2,key:2,label:"anft"},{value:3,key:3,label:"milestone"},{value:4,key:4,label:"event"}],b=[{value:"points",key:"points",label:"积分",api:O,min:1,max:1e4},{value:"soul",key:"soul",label:"心灵点",api:Q,min:1,max:500},{value:"number",key:"blindbox",label:"盲盒",api:K,min:1,max:200},{value:"number",key:"ticketbox",label:"票盒",api:W,min:1,max:200},{value:"sxp",key:"sxp",label:"sxp",api:r=>{if(r.addrs&&r.addrs.trim()!==""){const t=r.addrs.split(",").map(l=>l.trim()).join(","),s={};return r.addrs.split(",").forEach(l=>{s[l.trim()]=Number(r.sxp)}),X({airdrop_type:r.airdrop_type||0,airdrop_task:r.airdrop_task||"",addrs:t,sxp:Number(r.sxp),addr_sxp_map:s})}else{const t={};return r.uids.split(",").forEach(s=>{t[s.trim()]=Number(r.sxp)}),Y({airdrop_type:r.airdrop_type||0,airdrop_task:r.airdrop_task||"",uids:r.uids,sxp:Number(r.sxp),user_sxp_map:t})}},min:1,max:1e4}],$=E({uids:[{required:!0,message:"请输入用户ID",trigger:"blur"},{validator:(r,t,s)=>{if(!t.trim()){s(new Error("请输入用户ID"));return}const l=t.split(",").map(i=>i.trim());for(const i of l){if(!/^\d+$/.test(i)){s(new Error("UID 格式错误，必须为数字"));return}if(i.length!==14){s(new Error("UID 长度必须为14位"));return}}s()},trigger:"blur"}],airdrop_task:[{required:!0,message:"请输入活动类型",trigger:"blur"}],num:[{required:!0,message:"请输入",trigger:"blur"},{validator:(r,t,s)=>{const l=b.find(i=>i.key===e.type);l&&(t<l.min||t>l.max)?s(new Error(`${l.label}数应在 ${l.min} 到 ${l.max} 之间`)):s()},trigger:"blur"}],type:[{required:!0,message:"请选择奖励类型",trigger:"change"}]}),_=h(!1),e=E({uids:"",addrs:"",type:"points",num:1,points:null,soul:null,sxp:null,blindbox:null,ticketbox:null,description:"",airdrop_type:"",airdrop_task:""});T(()=>e.type,r=>{r!==void 0&&(e.num=1)});const V=r=>{r&&r.resetFields()},F=async r=>{r&&(_.value||await r.validate(async(t,s)=>{if(!t)return;const l=b.find(i=>i.key===e.type);if(!l){c.error("未找到对应的奖励类型");return}try{_.value=!0;let i;if(e.type==="sxp"){const u={uids:e.uids,addrs:e.addrs,sxp:e.num,airdrop_type:e.airdrop_type,airdrop_task:e.airdrop_task};i=await l.api(u)}else{const k={uids:e.uids.split(",").map(y=>`${y.trim()}`).join(","),[l.value]:Number(e.num)};i=await l.api(k)}i.code===200?c.success(`${l.label}奖励发放成功,${i.data}`):c.error(i.msg||"奖励发放失败")}catch{c.error("奖励发放失败，请稍后再试")}finally{_.value=!1,V(r)}}))};return(r,t)=>{const s=C,l=j,i=L,u=q,k=z,y=P,R=G;return p(),g("div",te,[d(R,{ref_key:"ruleFormRef",ref:x,inline:!0,"label-position":"right","label-width":"90px",model:a(e),rules:a($),class:"flex flex-col w-fit"},{default:n(()=>[re,d(l,{label:"用户ID:",class:"w-[470px]"},{default:n(()=>[d(s,{autosize:"",type:"textarea",style:{width:"100%"},"controls-position":"right",modelValue:a(e).uids,"onUpdate:modelValue":t[0]||(t[0]=o=>a(e).uids=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),a(e).type==="sxp"?(p(),w(l,{key:0,label:"钱包地址:",prop:"addrs",class:"w-[470px]"},{default:n(()=>[d(s,{autosize:"",type:"textarea",style:{width:"100%"},"controls-position":"right",modelValue:a(e).addrs,"onUpdate:modelValue":t[1]||(t[1]=o=>a(e).addrs=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})):v("",!0),d(l,{label:"奖励:",prop:"type"},{default:n(()=>[d(u,{modelValue:a(e).type,"onUpdate:modelValue":t[2]||(t[2]=o=>a(e).type=o)},{default:n(()=>[(p(),g(I,null,U(b,(o,S)=>d(i,{label:o.key,key:o.key},{default:n(()=>[f(D(o.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),a(e).type==="sxp"?(p(),w(l,{key:1,label:"补发类型:",prop:"type"},{default:n(()=>[d(u,{modelValue:a(e).airdrop_type,"onUpdate:modelValue":t[3]||(t[3]=o=>a(e).airdrop_type=o)},{default:n(()=>[(p(),g(I,null,U(B,(o,S)=>d(i,{label:o.key,key:o.key},{default:n(()=>[f(D(o.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})):v("",!0),a(e).type==="sxp"&&a(e).airdrop_type===3||a(e).airdrop_type===4?(p(),w(l,{key:2,label:"活动类型:",prop:"airdrop_task"},{default:n(()=>[d(s,{autosize:"",style:{width:"100%"},"controls-position":"right",modelValue:a(e).airdrop_task,"onUpdate:modelValue":t[4]||(t[4]=o=>a(e).airdrop_task=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})):v("",!0),d(l,{label:"数量:",prop:"num",class:"w-[350px]"},{default:n(()=>[d(k,{min:1,max:1e4,"controls-position":"right",modelValue:a(e).num,"onUpdate:modelValue":t[5]||(t[5]=o=>a(e).num=o),placeholder:"请输入",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),N("div",le,[d(y,{class:"w-[20%]",type:"danger",onClick:t[6]||(t[6]=o=>V(a(x)))},{default:n(()=>[f(" 重置 ")]),_:1}),d(y,{class:"w-[20%]",type:"success",loading:a(_),onClick:t[7]||(t[7]=o=>("throttle"in r?r.throttle:a(Z))(()=>{F(a(x))}))},{default:n(()=>[f(" 发放 ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])])}}});const fe=M(ae,[["__scopeId","data-v-efa74795"]]);export{fe as default};
