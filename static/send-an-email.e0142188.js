import{d as j,r as f,V as R,P as C,q as $,s as k,W as O,h as g,o as b,c as w,f as r,w as u,b as _,u as a,X as F,D as V,Y as H,Z as N,p as T,a as P,_ as U,e as E,x as q,g as z,i as D,j as A,l as J,m as M}from"./entry.a0733539.js";import{_ as W}from"./client-only.98e565f9.js";import{i as I}from"./index.a0298ae1.js";/* empty css                 *//* empty css                *//* empty css                  */import{J as L}from"./adminManage.e685492d.js";import{t as X}from"./throttle.46d02480.js";import"./request.489c0e61.js";const Y=c=>(T("data-v-69ee3d2d"),c=c(),P(),c),Z={key:0,class:"bg-black fixed inset-0 z-[99999999] overflow-scroll w-full h-full flex justify-center items-center px-6 py-4"},G=["src"],K=Y(()=>_("span",{class:"w-full h-full flex justify-center items-center text-white"},[_("span",{class:"iconfont icon-error text-2xl font-bold"})],-1)),Q=[K],ee=j({__name:"wangEditor",props:{txtHtml:{default:""},defaulTxtHtml:{default:""},isReadOnly:{type:Boolean,default:!0},isShowBorder:{type:Boolean,default:!1}},emits:["update:html-data"],setup(c,{emit:d}){const i=c,o=f(null),e=f(null),y=R(),m=f();return C(()=>i.txtHtml,l=>{I(e.value)||e.value.txt.html(l)},{deep:!0}),C(()=>i.isReadOnly,l=>{I(e.value)||e.value.$textElem.attr("contenteditable",l)},{deep:!0}),$(async()=>{await k(),O(()=>import("./wangEditor.be87a685.js").then(l=>l.w),["./wangEditor.be87a685.js","./entry.a0733539.js","./entry.a04240f8.css"],import.meta.url).then(l=>{e.value=new l.default(o.value),e.value.customConfig=e.value.customConfig?e.value.customConfig:e.value.config,e.value.customConfig.menus=i.isReadOnly?["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","list","justify","quote","emoticon","table","undo","redo"]:[],e.value.config.uploadImgHeaders={Authorization:`Bearer ${y.getToken}`},e.value.customConfig.uploadFileName="file",e.value.customConfig.uploadImgServer="/api/file/upload",e.value.customConfig.uploadImgHooks={success:function(s,t,n){},fail:function(){g({message:"上传成功，插入失败",grouping:!0,type:"error"})},error:function(){g({message:"上传失败，请重试",grouping:!0,type:"error"})},timeout:function(){g({message:"上传超时！",grouping:!0,type:"error"})}},e.value.config.pasteIgnoreImg=!0,e.value.config.customUploadImg=async(s,t)=>{},e.value.create(JSON.parse(JSON.stringify(i.txtHtml))),e.value.$textElem.attr("contenteditable",i.isReadOnly),k(()=>{e.value.txt.html(i.txtHtml)}),e.value.config.onchange=s=>{d("update:html-data",s)},e.value.$textElem.on("click","img",function(s){s.stopPropagation(),m.value=s.target.getAttribute("src")})}).catch(l=>{})}),(l,s)=>{const t=W;return b(),w("div",{class:N(["w-[50%] h-[450px]",{is_read_only:!l.$props.isReadOnly,is_show_border:l.isShowBorder}])},[r(t,null,{default:u(()=>[_("div",{ref_key:"editorEl",ref:o,class:"editorEl_box h-full flex flex-col justify-between"},null,512)]),_:1}),r(H,{name:"fade"},{default:u(()=>[a(m)?(b(),w("div",Z,[_("img",{src:a(m),alt:"",class:"max-h-full object-cover"},null,8,G),_("div",{class:"w-10 h-10 bg-red bg-opacity-80 rounded-full fixed z-20 top-12 right-12 cursor-pointer",onClick:s[0]||(s[0]=F(n=>m.value="",["stop"]))},Q)])):V("",!0)]),_:1})],2)}}});const te=U(ee,[["__scopeId","data-v-69ee3d2d"]]),oe={class:"text-[#ebebeb] p-12"},le={class:"w-[65%] flex justify-center"},pe=j({__name:"send-an-email",setup(c){const d=f(!1),i=f(""),o=E({email:"",subject:"",content:""}),e=f(),y=E({email:[{required:!0,message:"请输入",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],subject:[{required:!0,message:"请输入",trigger:"blur"}],content:[{required:!0,message:"请输入",trigger:"blur"}]}),m=t=>{o.content=t},l=t=>{t&&t.resetFields()},s=async t=>{t&&(d.value||await t.validate(async(n,x)=>{if(n)try{d.value=!0;const p={...o,subject:btoa(unescape(encodeURIComponent(o.subject))),content:btoa(unescape(encodeURIComponent(o.content)))},h=await L(p);h.code===200?g.success({message:"发送成功",grouping:!0,type:"success"}):g.error({message:h.msg,grouping:!0,type:"error"})}catch{}finally{d.value=!1,o.content="",l(t)}}))};return(t,n)=>{const x=D,p=A,h=te,S=J,B=M;return b(),w("div",oe,[r(B,{ref_key:"ruleFormRef",ref:e,class:"w-full",inline:!0,"label-position":"right","label-width":"140px",model:a(o),rules:a(y)},{default:u(()=>[a(o).id?V("",!0):(b(),q(p,{key:0,label:"收件人:",prop:"email",class:"w-full"},{default:u(()=>[r(x,{style:{width:"50%"},modelValue:a(o).email,"onUpdate:modelValue":n[0]||(n[0]=v=>a(o).email=v),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})),r(p,{label:"主题:",prop:"subject",class:"w-full"},{default:u(()=>[r(x,{style:{width:"50%"},modelValue:a(o).subject,"onUpdate:modelValue":n[1]||(n[1]=v=>a(o).subject=v),placeholder:"请输入",clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1}),r(p,{label:"正文:",prop:"content",class:"w-full"},{default:u(()=>[r(h,{"txt-html":a(i),"onUpdate:htmlData":m},null,8,["txt-html"])]),_:1}),_("div",le,[r(S,{class:"w-[20%]",type:"success",loading:a(d),onClick:n[2]||(n[2]=v=>("throttle"in t?t.throttle:a(X))(()=>{s(a(e))}))},{default:u(()=>[z(" 发送 ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])])}}});export{pe as default};
