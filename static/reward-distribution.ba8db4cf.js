import{d as T,r as E,e as I,P as C,o as p,c as k,f as d,w as n,u as a,x as w,D as v,I as D,J as U,b as B,g as c,h as f,i as j,j as q,R as z,k as P,l as G,m as H,y as N,p as J,a as L,Q as M,_ as Q}from"./entry.0bf2c468.js";/* empty css                 *//* empty css                *//* empty css                       *//* empty css                        *//* empty css                  */import{D as K,E as O,F as W,G as X,H as Y,I as Z}from"./adminManage.55492bb0.js";import{t as ee}from"./throttle.46d02480.js";import"./request.38816b5a.js";const te=m=>(J("data-v-9e0c14a7"),m=m(),L(),m),re={class:"w-fit text-[#EBEBEB] pl-10 mt-10"},le=te(()=>B("p",{class:"text-red-500 text-[12px] ml-24 mb-2"},"注：多个账户用逗号隔开",-1)),ae={class:"w-full flex justify-end"},oe=T({__name:"reward-distribution",setup(m){const b=E(),$=[{value:1,key:1,label:"snft"},{value:2,key:2,label:"anft"},{value:3,key:3,label:"milestone"},{value:4,key:4,label:"event"}],x=[{value:"points",key:"points",label:"积分",api:K,min:1,max:1e4},{value:"soul",key:"soul",label:"心灵点",api:O,min:1,max:500},{value:"number",key:"blindbox",label:"盲盒",api:W,min:1,max:200},{value:"number",key:"ticketbox",label:"票盒",api:X,min:1,max:200},{value:"sxp",key:"sxp",label:"sxp",api:r=>{if(r.addrs&&r.addrs.trim()!==""){const t=r.addrs.split(",").map(l=>l.trim()).join(","),s={};return r.addrs.split(",").forEach(l=>{s[l.trim()]=Number(r.sxp)}),Y({airdrop_type:r.airdrop_type||0,airdrop_task:r.airdrop_task||"",addrs:t,sxp:Number(r.sxp),addr_sxp_map:s})}else{const t={};return r.uids.split(",").forEach(s=>{t[s.trim()]=Number(r.sxp)}),Z({airdrop_type:r.airdrop_type||0,airdrop_task:r.airdrop_task||"",uids:r.uids,sxp:Number(r.sxp),user_sxp_map:t})}},min:1,max:1e4}],V=(r,t,s)=>{if(!t.trim()){s(new Error("请输入用户ID"));return}const l=t.split(",").map(i=>i.trim());for(const i of l){if(!/^\d+$/.test(i)){s(new Error("UID 格式错误，必须为数字"));return}if(i.length!==14){s(new Error("UID 长度必须为14位"));return}}s()},F=I({uids:[{required:!0,message:"请输入用户ID",trigger:"blur"},{validator:V,trigger:"blur"}],airdrop_task:[{required:!0,message:"请输入活动类型",trigger:"blur"},{validator:V,trigger:"blur"}],num:[{required:!0,message:"请输入",trigger:"blur"},{validator:(r,t,s)=>{const l=x.find(i=>i.key===e.type);l&&(t<l.min||t>l.max)?s(new Error(`${l.label}数应在 ${l.min} 到 ${l.max} 之间`)):s()},trigger:"blur"}],type:[{required:!0,message:"请选择奖励类型",trigger:"change"}]}),_=E(!1),e=I({uids:"",addrs:"",type:"points",num:1,points:null,soul:null,sxp:null,blindbox:null,ticketbox:null,description:"",airdrop_type:"",airdrop_task:""});C(()=>e.type,r=>{r!==void 0&&(e.num=1)});const h=r=>{r&&r.resetFields()},R=async r=>{r&&(_.value||await r.validate(async(t,s)=>{if(!t)return;const l=x.find(i=>i.key===e.type);if(!l){f.error("未找到对应的奖励类型");return}try{_.value=!0;let i;if(e.type==="sxp"){const u={uids:e.uids,addrs:e.addrs,sxp:e.num,airdrop_type:e.airdrop_type,airdrop_task:e.airdrop_task};i=await l.api(u)}else{const g={uids:e.uids.split(",").map(y=>`${y.trim()}`).join(","),[l.value]:Number(e.num)};i=await l.api(g)}i.code===200?f.success(`${l.label}奖励发放成功,${i.data}`):f.error(i.msg||"奖励发放失败")}catch{f.error("奖励发放失败，请稍后再试")}finally{_.value=!1,h(r)}}))};return(r,t)=>{const s=j,l=q,i=M,u=z,g=P,y=G,S=H;return p(),k("div",re,[d(S,{ref_key:"ruleFormRef",ref:b,inline:!0,"label-position":"right","label-width":"90px",model:a(e),rules:a(F),class:"flex flex-col w-fit"},{default:n(()=>[le,d(l,{label:"用户ID:",class:"w-[470px]"},{default:n(()=>[d(s,{autosize:"",type:"textarea",style:{width:"100%"},"controls-position":"right",modelValue:a(e).uids,"onUpdate:modelValue":t[0]||(t[0]=o=>a(e).uids=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),a(e).type==="sxp"?(p(),w(l,{key:0,label:"钱包地址:",prop:"addrs",class:"w-[470px]"},{default:n(()=>[d(s,{autosize:"",type:"textarea",style:{width:"100%"},"controls-position":"right",modelValue:a(e).addrs,"onUpdate:modelValue":t[1]||(t[1]=o=>a(e).addrs=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})):v("",!0),d(l,{label:"奖励:",prop:"type"},{default:n(()=>[d(u,{modelValue:a(e).type,"onUpdate:modelValue":t[2]||(t[2]=o=>a(e).type=o)},{default:n(()=>[(p(),k(D,null,U(x,(o,A)=>d(i,{label:o.key,key:o.key},{default:n(()=>[c(N(o.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),a(e).type==="sxp"?(p(),w(l,{key:1,label:"补发类型:",prop:"type"},{default:n(()=>[d(u,{modelValue:a(e).airdrop_type,"onUpdate:modelValue":t[3]||(t[3]=o=>a(e).airdrop_type=o)},{default:n(()=>[(p(),k(D,null,U($,(o,A)=>d(i,{label:o.key,key:o.key},{default:n(()=>[c(N(o.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})):v("",!0),a(e).type==="sxp"&&a(e).airdrop_type===3||a(e).airdrop_type===4?(p(),w(l,{key:2,label:"活动类型:",prop:"airdrop_task"},{default:n(()=>[d(s,{autosize:"",style:{width:"100%"},"controls-position":"right",modelValue:a(e).airdrop_task,"onUpdate:modelValue":t[4]||(t[4]=o=>a(e).airdrop_task=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})):v("",!0),d(l,{label:"数量:",prop:"num",class:"w-[350px]"},{default:n(()=>[d(g,{min:1,max:1e4,"controls-position":"right",modelValue:a(e).num,"onUpdate:modelValue":t[5]||(t[5]=o=>a(e).num=o),placeholder:"请输入",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),B("div",ae,[d(y,{class:"w-[20%]",type:"danger",onClick:t[6]||(t[6]=o=>h(a(b)))},{default:n(()=>[c(" 重置 ")]),_:1}),d(y,{class:"w-[20%]",type:"success",loading:a(_),onClick:t[7]||(t[7]=o=>("throttle"in r?r.throttle:a(ee))(()=>{R(a(b))}))},{default:n(()=>[c(" 发放 ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])])}}});const ce=Q(oe,[["__scopeId","data-v-9e0c14a7"]]);export{ce as default};
