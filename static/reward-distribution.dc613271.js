import{d as A,r as v,e as V,P as T,o as u,c as w,f as d,w as n,u as s,x as E,D as h,I,J as D,b as N,g as f,h as y,i as C,j,R as q,k as P,l as z,m as G,y as U,p as H,a as J,Q as L,_ as M}from"./entry.7f6f710e.js";/* empty css                 *//* empty css                *//* empty css                       *//* empty css                        *//* empty css                  */import{D as Q,E as K,F as O,G as W,H as X,I as Y}from"./adminManage.9e374054.js";import{t as Z}from"./throttle.46d02480.js";import"./request.52ccf9bb.js";const ee=m=>(H("data-v-bcdf0eeb"),m=m(),J(),m),te={class:"w-fit text-[#EBEBEB] pl-10 mt-10"},re=ee(()=>N("p",{class:"text-red-500 text-[12px] ml-24 mb-2"},"注：多个账户用逗号隔开",-1)),le={class:"w-full flex justify-end"},oe=A({__name:"reward-distribution",setup(m){const b=v(),B=[{value:1,key:1,label:"snft"},{value:2,key:2,label:"anft"}],x=[{value:"points",key:"points",label:"积分",api:Q,min:1,max:1e4},{value:"soul",key:"soul",label:"心灵点",api:K,min:1,max:500},{value:"blindbox",key:"blindbox",label:"盲盒",api:O,min:1,max:200},{value:"ticketbox",key:"ticketbox",label:"票盒",api:W,min:1,max:200},{value:"sxp",key:"sxp",label:"sxp",api:e=>{if(e.addrs&&e.addrs.trim()!==""){const t=e.addrs.split(",").map(l=>l.trim()).join(","),i={};return e.addrs.split(",").forEach(l=>{i[l.trim()]=Number(e.sxp)}),X({airdrop_type:e.airdrop_type||0,airdrop_task:e.airdrop_task||"",addrs:t,sxp:Number(e.sxp),addr_sxp_map:i})}else{const t={};return e.uids.split(",").forEach(i=>{t[i.trim()]=Number(e.sxp)}),Y({airdrop_type:e.airdrop_type||0,airdrop_task:e.airdrop_task||"",uids:e.uids,sxp:Number(e.sxp),user_sxp_map:t})}},min:1,max:1e4}],$=V({uids:[{required:!0,message:"请输入用户ID",trigger:"blur"},{validator:(e,t,i)=>{if(!t.trim()){i(new Error("请输入用户ID"));return}const l=t.split(",").map(a=>a.trim());for(const a of l){if(!/^\d+$/.test(a)){i(new Error("UID 格式错误，必须为数字"));return}if(a.length!==14){i(new Error("UID 长度必须为14位"));return}}i()},trigger:"blur"}],num:[{required:!0,message:"请输入",trigger:"blur"},{validator:(e,t,i)=>{const l=x.find(a=>a.key===r.type);l&&(t<l.min||t>l.max)?i(new Error(`${l.label}数应在 ${l.min} 到 ${l.max} 之间`)):i()},trigger:"blur"}],type:[{required:!0,message:"请选择奖励类型",trigger:"change"}]}),_=v(!1),r=V({uids:"",addrs:"",type:"points",num:1,points:null,soul:null,sxp:null,blindbox:null,ticketbox:null,description:"",airdrop_type:1});T(()=>r.type,e=>{e!==void 0&&(r.num=1)});const k=e=>{e&&e.resetFields()},F=async e=>{e&&(_.value||await e.validate(async(t,i)=>{if(!t)return;const l=x.find(a=>a.key===r.type);if(!l){y.error("未找到对应的奖励类型");return}try{_.value=!0;let a;if(r.type==="sxp"){const p={uids:r.uids,addrs:r.addrs,sxp:r.num,airdrop_type:r.airdrop_type,airdrop_task:"1"};a=await l.api(p)}else{const g={uids:r.uids.split(",").map(c=>`${c.trim()}`).join(","),[l.value]:Number(r.num)};a=await l.api(g)}a.code===200?y.success(`${l.label}奖励发放成功,${a.data}`):y.error(a.msg||"奖励发放失败")}catch{y.error("奖励发放失败，请稍后再试")}finally{_.value=!1,k(e)}}))};return(e,t)=>{const i=C,l=j,a=L,p=q,g=P,c=z,R=G;return u(),w("div",te,[d(R,{ref_key:"ruleFormRef",ref:b,inline:!0,"label-position":"right","label-width":"90px",model:s(r),rules:s($),class:"flex flex-col w-fit"},{default:n(()=>[re,d(l,{label:"用户ID:",class:"w-[470px]"},{default:n(()=>[d(i,{autosize:"",type:"textarea",style:{width:"100%"},"controls-position":"right",modelValue:s(r).uids,"onUpdate:modelValue":t[0]||(t[0]=o=>s(r).uids=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),s(r).type==="sxp"?(u(),E(l,{key:0,label:"钱包地址:",prop:"addrs",class:"w-[470px]"},{default:n(()=>[d(i,{autosize:"",type:"textarea",style:{width:"100%"},"controls-position":"right",modelValue:s(r).addrs,"onUpdate:modelValue":t[1]||(t[1]=o=>s(r).addrs=o),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})):h("",!0),d(l,{label:"奖励:",prop:"type"},{default:n(()=>[d(p,{modelValue:s(r).type,"onUpdate:modelValue":t[2]||(t[2]=o=>s(r).type=o)},{default:n(()=>[(u(),w(I,null,D(x,(o,S)=>d(a,{label:o.key,key:o.key},{default:n(()=>[f(U(o.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),s(r).type==="sxp"?(u(),E(l,{key:1,label:"补发类型:",prop:"type"},{default:n(()=>[d(p,{modelValue:s(r).airdrop_type,"onUpdate:modelValue":t[3]||(t[3]=o=>s(r).airdrop_type=o)},{default:n(()=>[(u(),w(I,null,D(B,(o,S)=>d(a,{label:o.key,key:o.key},{default:n(()=>[f(U(o.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})):h("",!0),d(l,{label:"数量:",prop:"num",class:"w-[350px]"},{default:n(()=>[d(g,{min:1,max:1e4,"controls-position":"right",modelValue:s(r).num,"onUpdate:modelValue":t[4]||(t[4]=o=>s(r).num=o),placeholder:"请输入",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),N("div",le,[d(c,{class:"w-[20%]",type:"danger",onClick:t[5]||(t[5]=o=>k(s(b)))},{default:n(()=>[f(" 重置 ")]),_:1}),d(c,{class:"w-[20%]",type:"success",loading:s(_),onClick:t[6]||(t[6]=o=>("throttle"in e?e.throttle:s(Z))(()=>{F(s(b))}))},{default:n(()=>[f(" 发放 ")]),_:1},8,["loading"])])]),_:1},8,["model","rules"])])}}});const fe=M(oe,[["__scopeId","data-v-bcdf0eeb"]]);export{fe as default};
